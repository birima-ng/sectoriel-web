<div class="row">
  <div class="col-11">
    <div class="content-header">Configuration p√©riode prix et stock</div>
  </div>
  <!--
  <div class="col-1">
    <div class="content-header">    <button type="button" class="btn btn-primary mr-2" (click)="openContent()"><i class="ft-check-square mr-1"></i>Ajouter</button></div>
  </div> -->
</div>
<!--Grid options Starts-->
<section id="grid-option">
  <div class="row">
    <div class="col-12">
      <div class="card">
       <!-- <div class="card-header">
          <div class="col-11">

          </div>
          <div class="col-1">
            <div class="content-header">    <button type="button" class="btn btn-primary mr-2" (click)="openContent()"><i class="ft-check-square mr-1"></i>Ajouter</button></div>
          </div>

        </div>-->
        <div class="card-content">
          <div class="card-body">

              <div class="card-body table-responsive">

                <div class="container-fluid navbar-wrapper">
                  <mat-sidenav-container class="sidenav-container">
                    <mat-sidenav mode="side" opened class="sidenav">
                      <!--<mat-toolbar>Menu</mat-toolbar>-->
                      <mat-tree [dataSource]="dataSource" [treeControl]="treeControl" class="menu-tree">

                        <!-- Noeud parent (R√©gion) -->
                        <mat-nested-tree-node *matTreeNodeDef="let node; when: hasChild">
                          <div class="tree-node region" (click)="toggleRegion(node)">
                            <span>{{ node.nom }}</span>
                            <mat-icon class="expand-icon">
                              {{ treeControl.isExpanded(node) ? 'expand_more' : 'chevron_right' }}
                            </mat-icon>
                          </div>
                          <!-- Ajout ici pour afficher les d√©partements lorsqu'une r√©gion est ouverte -->
                          <div *ngIf="treeControl.isExpanded(node)">
                            <ng-container matTreeNodeOutlet></ng-container>
                          </div>
                        </mat-nested-tree-node>

                        <!-- Noeud enfant (D√©partement) -->
                        <mat-tree-node *matTreeNodeDef="let node">
                          <div class="tree-node menu-item"
                               (click)="selectDepartment(node)"
                               [class.selected]="node.id === selectedDepartmentId">
                            üìç {{ node.nom }}
                          </div>
                        </mat-tree-node>

                      </mat-tree>
                    </mat-sidenav>

                    <mat-sidenav-content>
                      <!--<mat-toolbar color="primary">Contenu principal</mat-toolbar>-->
                      <div class="content">

                        <form [formGroup]="addForm">
                          <div class="form-row">
                           <!-- <div class="col-2">
                              <div class="form-group mb-2">
                                <label for="region">R√©gion</label>
                                <select class="form-control" (ngModelChange)="onChangeRegion($event)"   [(ngModel)]="region" [compareWith]="compareFn" formControlName="region" id="region" name="region" [ngClass]="{ 'is-invalid': submitted && lf.region.invalid, 'is-valid': submitted && !lf.region.invalid }" required>
                                  <option [ngValue]="null" >-- R√©gion --</option>
                                  <option *ngFor="let region of regions;" [ngValue]="region"  >{{region.nom }}</option>

                                </select>
                                <div *ngIf="submitted && (lf.region.invalid || lf.region.errors?.required)"
                                     class="help-block mt-1 text-danger"> <i class="ft-alert-circle align-middle"></i> This is
                                  required</div>
                              </div>
                            </div> -->
<!--
                            <div class="col-2">
                              <div class="form-group mb-2">
                                <label for="departement">Departement</label>
                                <select class="form-control" (ngModelChange)="onChangeDepartement($event)" [(ngModel)]="departement" [compareWith]="compareFn" formControlName="departement" id="departement" name="departement" [ngClass]="{ 'is-invalid': submitted && lf.departement.invalid, 'is-valid': submitted && !lf.departement.invalid }" required>
                                  <option [ngValue]="null" >-- Departement --</option>
                                  <option *ngFor="let departement of departements;" [ngValue]="departement"  >{{departement.nom }}</option>

                                </select>
                                <div *ngIf="submitted && (lf.departement.invalid || lf.departement.errors?.required)"
                                     class="help-block mt-1 text-danger"> <i class="ft-alert-circle align-middle"></i> This is
                                  required</div>
                              </div>
                            </div> -->
<!--
                            <div class="col-2">
                              <div class="form-group mb-2">
                                <label for="secteur">Secteur</label>
                                <select class="form-control"  (ngModelChange)="onChangeSecteur($event)" [(ngModel)]="secteur" [compareWith]="compareFn" formControlName="secteur" id="secteur" name="secteur" [ngClass]="{ 'is-invalid': submitted && lf.secteur.invalid, 'is-valid': submitted && !lf.secteur.invalid }" required>
                                  <option [ngValue]="null" >-- Secteur --</option>
                                  <option *ngFor="let secteur of secteurs;" [ngValue]="secteur"  >{{secteur.libelle }}</option>

                                </select>
                                <div *ngIf="submitted && (lf.secteur.invalid || lf.secteur.errors?.required)"
                                     class="help-block mt-1 text-danger"> <i class="ft-alert-circle align-middle"></i> This is
                                  required</div>
                              </div>
                            </div> -->
                            <div class="col-1">
                            </div>

                            <div class="col-2">
                              <div class="form-group">
                                <label for="pointcollecte">Point de collecte</label>
                                <input type="text" formControlName="pointcollecte" class="form-control" placeholder="Point de collecte" id="pointcollecte"
                                       [ngClass]="{ 'is-invalid': submitted && lf.pointcollecte.invalid, 'is-valid': submitted && !lf.pointcollecte.invalid }"
                                       required>
                                <div *ngIf="submitted && (lf.pointcollecte.invalid || lf.pointcollecte.errors?.required)"
                                     class="help-block mt-1 text-danger"> <i class="ft-alert-circle align-middle"></i> This is
                                  required</div>
                              </div>
                            </div>

                            <div class="col-2">
                              <div class="form-group">
                                <label for="telephone">T√©l√©phonne</label>
                                <input type="text" formControlName="telephone" class="form-control" placeholder="T√©l√©phone" id="telephone"
                                       [ngClass]="{ 'is-invalid': submitted && lf.telephone.invalid, 'is-valid': submitted && !lf.datecollecte.invalid }"
                                       required>
                                <div *ngIf="submitted && (lf.telephone.invalid || lf.telephone.errors?.required)"
                                     class="help-block mt-1 text-danger"> <i class="ft-alert-circle align-middle"></i> This is
                                  required</div>
                              </div>
                            </div>

                            <div class="col-3">
                              <div class="form-group mb-2">
                                <label for="stadecommerce">Stade de commerce</label>
                                <select class="form-control"   (ngModelChange)="onChangeStadeCommerce($event)" [(ngModel)]="stadecommerce" [compareWith]="compareFn" formControlName="stadecommerce" id="stadecommerce" name="stadecommerce" [ngClass]="{ 'is-invalid': submitted && lf.stadecommerce.invalid, 'is-valid': submitted && !lf.stadecommerce.invalid }" required>
                                  <option [ngValue]="null" >-- Stade de commerce --</option>
                                  <option *ngFor="let stadecommerce of stadecommerces;" [ngValue]="stadecommerce"  >{{stadecommerce.libelle }}</option>

                                </select>
                                <div *ngIf="submitted && (lf.stadecommerce.invalid || lf.stadecommerce.errors?.required)"
                                     class="help-block mt-1 text-danger"> <i class="ft-alert-circle align-middle"></i> This is
                                  required</div>
                              </div>
                            </div>

                            <div class="col-2">
                              <div class="form-group mb-2">
                              <button type="button" class="btn btn-primary mr-2" id="send" (click)="onSearch()"><i class="ft-check-square mr-1"></i>Rechercher</button>
                              </div>
                            </div>
                            <div class="col-2">
                              <div class="form-group mb-2">
                                <button *ngIf="selectedDepartmentId" type="button" class="btn btn-primary mr-2" (click)="openContent()"><i class="ft-check-square mr-1"></i>Ajouter</button>
                              </div>
                            </div>

                           <!-- <div class="col-2">
                              <div class="form-group mb-2">
                                <label for="entreprise">Entreprise</label>
                                <select class="form-control"   (ngModelChange)="onChangeEntreprise($event)" [(ngModel)]="entreprise" [compareWith]="compareFn" formControlName="entreprise" id="entreprise" name="entreprise" [ngClass]="{ 'is-invalid': submitted && lf.entreprise.invalid, 'is-valid': submitted && !lf.entreprise.invalid }" required>
                                  <option [ngValue]="null" >-- Entreprise --</option>
                                  <option *ngFor="let entreprise of entreprises;" [ngValue]="entreprise"  >{{entreprise.nom }}</option>

                                </select>
                                <div *ngIf="submitted && (lf.entreprise.invalid || lf.entreprise.errors?.required)"
                                     class="help-block mt-1 text-danger"> <i class="ft-alert-circle align-middle"></i> This is
                                  required</div>
                              </div>
                            </div> -->

                          </div>
                        </form>
                        <!--
                        <table class="table  m-0">
                          <thead>
                          <tr>
                            <th >Date de collecte</th>
                            <th >Unit√©</th>
                            <th >Entreprise</th>
                            <th >Gestion stock</th>
                            <th >Stade de commerce</th>
                            <th width="5%">Actions</th>
                          </tr>
                          </thead>
                          <tbody *ngIf="enteteconfigprixs">
                          <tr  *ngFor="let enteteconfigprix  of enteteconfigprixs;">
                            <td>{{enteteconfigprix.datecollecte | date:'dd/MM/yyyy'}}</td>
                            <td>{{enteteconfigprix.unite?.libelle}}</td>
                            <td>{{enteteconfigprix.entreprise?.nom}}</td>
                            <td *ngIf="enteteconfigprix.entreprise.stocked"> <span  class="badge badge-success mb-0 mr-0">Stock¬†et Prix importateur</span> </td>
                            <td *ngIf="!enteteconfigprix.entreprise.stocked"> <span  class="badge badge-danger mb-0 mr-0">Prix d√©taillant</span></td>
                            <td>{{enteteconfigprix.entreprise?.stadecommerce?.libelle}}</td>
                            <td class="text-truncate">
                              <a href="javascript:;" class="success p-0" (click)="formEdit(enteteconfigprix)">
                                <i class="ft-edit-2 font-medium-3 mr-2"></i>
                              </a>
                              <a href="javascript:;" class="danger p-0" (click)="formDelete(enteteconfigprix.id)">
                                <i class="ft-x font-medium-3"></i>
                              </a>
                              <a href="javascript:;" class="warning p-0" routerLink="/components/configuration-prix" [queryParams]="{ vwp: enteteconfigprix.id }">
                                <i class="ft-more-vertical font-medium-3 mr-2"></i>
                              </a>
                            </td>
                          </tr>
                          </tbody>
                        </table>
-->
                        <table class="table  m-0">
                          <thead>
                          <tr>
                            <th >Point de collecte</th>
                            <th >T√©l√©phone</th>
                            <th >Stade commerce</th>
                            <th >Stock/Prix</th>
                          </tr>
                          </thead>
                          <tbody *ngIf="entreprises">
                          <tr  *ngFor="let entreprise  of entreprises;">
                            <td>{{entreprise.nom}}</td>
                            <td>{{entreprise.telephoneportable}}</td>
                            <td>{{entreprise.stadecommerce.libelle}}</td>
                            <td> <a href="javascript:;" class="success p-0" routerLink="/components/configuration-prix" [queryParams]="{ vwp: entreprise.id }">
                              Ajout collecte<i class="ft-plus font-medium-3 mr-2"></i>
                            </a></td>
                          </tr>
                          </tbody>
                        </table>

                       <!-- <p *ngIf="selectedDepartmentId">‚úÖ D√©partement actif : <strong>{{ selectedDepartmentId }}</strong></p> -->
                      </div>
                    </mat-sidenav-content>
                  </mat-sidenav-container>
                </div>


              </div>

          </div>
        </div>
      </div>
    </div>

  </div>
</section>
<!--Grid options Ends-->

